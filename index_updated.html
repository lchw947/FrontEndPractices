<!DOCTYPE html>

<html>
<head>
		<title>WELCOME TO CINDY's RESTAURANT</title>
		<p>WELCOME TO CINDY's RESTAURANT</p>
		
		<script type="text/javascript" src="db.js"></script>
		<script type="text/javascript">
			window.onload = function() {
				populateTable("menuTable", entrees);

			}
		
		function searchMatch(){

			var searchID = document.getElementById('searchKey').value.toLowerCase();
			console.log(searchID);
				var searMatch = [];
				for (var i=0; i<entrees.length;i++){
					var entree= entrees[i];
					var name = entree["name"].toLowerCase();
					var ingres = entree["ingredients"];
					
					for (var j=0 ; j<ingres.length; j++){
						var ing = ingres[j].toLowerCase();
			
						if (name.indexOf(searchID)>-1){
							searMatch.push(entree);
							break;
						}
						else if (ing.indexOf(searchID)>-1){
							searMatch.push(entree);
							break;
						}
				
					}
				}	
				populateTable("menuTable",searMatch);
				return true;
		}

		function populateTable (tableID,data) {
			
			document.getElementById(tableID).innerHTML = null;
			var header = document.getElementById(tableID).createTHead();
			header = header.insertRow(0);
			header.insertCell(0).innerHTML= "Entree";
			header.insertCell(1).innerHTML= "Price";
			header.insertCell(2).innerHTML= "Ingredients";
			
			document.getElementById(tableID).createTBody();
			
			for(i=0;i<data.length;i++){
				var entree= data[i];
				var name= entree["name"];
				var price= entree["price"];
				var ingres= entree["ingredients"];
				
				var tableref = document.getElementById(tableID).tBodies[0];
				
				
				tableref = tableref.insertRow(i);
				tableref.insertCell(0).innerHTML= name;
				tableref.insertCell(1).innerHTML= price;
				tableref.insertCell(2).innerHTML= ingres;
			}
			return true;
		}

		function sortPrice(){
			var array = entrees.slice();
			var len = entrees.length
			for(var i=0; i<len; i++){
				
				for (var j=0; j<i; j++){
					if (array[i]["price"]<array[j]["price"]){
							var tempPrice = array[i]["price"];
							array[i]["price"] = array[j]["price"];
							array[j]["price"] = tempPrice;								
						
							var tempName = array[i]["name"];
							array[i]["name"] = array[j]["name"];
							array[j]["name"] = tempName;	

							var tempIngres = array[i]["ingredients"];
							array[i]["ingredients"] = array[j]["ingredients"];
							array[j]["ingredients"] = tempIngres;	
					}	
				
				}

			}
			populateTable("menuTable",array);
			return true;
		}
		</script>
		
</head>
<body>

	<div class="container">
		<table id="menuTable"></table>
		<table id="searchTable"></table>
	</div>
	<div>
  	Enter name: <input type="text" id="searchKey" onkeydown="if(event.keyCode == 13) document.getElementById('submit').click()"/>
  	<input type="submit" id="submit" value="Submit" onClick="searchMatch()">

 	<button id="sortPrice" onclick="sortPrice()">Sort</button>

  </div>
</body>	

<style type="text/css">
	#head, p{
		text-align: center;
	}
	#menuTable, td{
		text-align: left;
		padding: 5px;
		border: solid;
		border-spacing: double;
	}

</style>

</html>
